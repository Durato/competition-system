<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard - Technovação</title>
  <!-- CSP: Segurança reforçada para o painel administrativo -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data: http: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src 'self' http: https:;">
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>

<!-- LOADING OVERLAY -->
<div id="loadingOverlay">
  <div class="spinner"></div>
</div>

<!-- CONFIRMATION MODAL -->
<div class="modal" id="confirmModal">
  <div class="modal-box" style="text-align: center;">
    <h2 id="confirmTitle">Tem certeza?</h2>
    <p id="confirmMessage" style="color: #ccc; margin-bottom: 25px;">Essa ação não pode ser desfeita.</p>
    <div style="display: flex; gap: 10px; justify-content: center;">
      <button id="btnConfirmYes" style="background-color: #ef4444; min-width: 100px;">Sim</button>
      <button onclick="closeModal('confirm')" style="background: transparent; border: 1px solid var(--border); color: var(--text); min-width: 100px;">Cancelar</button>
    </div>
  </div>
</div>

<!-- DASHBOARD -->
<div id="dashboard">

  <header>
    <h2 id="userName">Usuário</h2>
    <button onclick="logout()">Sair</button>
  </header>

  <!-- EQUIPES -->
  <section>
    <h3>Minhas Equipes</h3>
    <div id="teamSection"></div>
  </section>

  <!-- MEMBROS -->
  <section id="membersSection" style="display:none">
    <h3>Membros</h3>
    <ul id="membersList"></ul>
    <div id="addMemberArea">
      <h4 style="margin-top: 1rem; margin-bottom: 0.5rem; color: var(--primary);">Adicionar Membro</h4>
      <div id="memberMessage" style="margin-bottom: 0.5rem; font-size: 0.9rem; color: #f87171;"></div>
      <form onsubmit="handleAddMember(event)">
        <input id="memberEmail" type="email" placeholder="Email do membro" required />
        <button>Adicionar</button>
      </form>
    </div>
  </section>

  <!-- ROBÔS -->
  <section id="teamRobotsSection" style="display:none">
    <h3>Robôs</h3>
    <ul id="teamRobotsList"></ul>
  </section>

  <!-- CADASTRAR ROBÔ -->
  <section id="robotSection" style="display:none">
    <h3>Cadastrar Robô</h3>
    <div id="robotMessage"></div>
    <form onsubmit="handleCreateRobot(event)">
      <input id="robotName" placeholder="Nome do robô" required />
      <label for="robotPhoto" style="display: block; margin-top: 10px; margin-bottom: 5px; color: var(--text); font-size: 0.9rem;">Foto do robô</label>
      <input type="file" id="robotPhoto" accept="image/*" style="background: var(--surface); color: var(--text);" required />
      <select id="robotCategory" required>
        <option value="">Selecione categoria</option>
      </select>
      <button>Cadastrar</button>
    </form>
  </section>

  <!-- PAGAMENTOS -->
  <section id="paymentSection" style="display:none; border-color: #22c55e;">
    <h3 style="color: #22c55e;">Pagamentos Pendentes</h3>
    <p style="font-size: 0.9rem; color: #aaa; margin-bottom: 20px;">Selecione os itens para pagar (Apenas Líder) — <span style="color: #f87171;">Limite de 400 inscritos pagos no evento.</span></p>
    
    <div id="paymentList">
      <!-- Checkboxes serão gerados aqui -->
    </div>

    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
      <h3 id="totalPrice" style="margin:0;">Total: R$ 0,00</h3>
      <button onclick="handleCheckout()" style="background-color: #22c55e;">Pagar Agora</button>
    </div>
  </section>

  <!-- CRIAR EQUIPE -->
  <section>
    <h3>Criar Nova Equipe</h3>
    <div id="createTeamMessage" style="margin-bottom: 10px; font-size: 0.9rem;"></div>
    <form onsubmit="handleCreateTeam(event)">
      <input id="teamName" placeholder="Nome da equipe" required />
      <input id="teamInstitution" placeholder="Instituição de Ensino / Empresa" required />
      <label for="teamPhoto" style="display: block; margin-top: 10px; margin-bottom: 5px; color: var(--text); font-size: 0.9rem;">Foto da equipe</label>
      <input type="file" id="teamPhoto" accept="image/*" style="background: var(--surface); color: var(--text);" required />
      <button>Criar Equipe</button>
    </form>
  </section>

  <div class="card">
    <h3>Robôs por Categoria</h3>
    <div id="robotsByCategory" class="robots-grid"></div>
  </div>

</div>

<script src="config.js?v=3"></script>
<script src="validators.js?v=3"></script>
<script src="app.js?v=3"></script>
</body>
</html>